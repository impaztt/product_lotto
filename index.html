<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로또픽스튜디오</title>
    <link rel="stylesheet" href="style.css?v=20260227">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
</head>
<body data-theme="light">
    <header class="site-header">
        <div class="logo">로또픽스튜디오</div>
        <div class="header-actions">
            <button id="theme-toggle" class="icon-btn" type="button" aria-label="테마 변경" title="테마 변경">
                <span class="theme-icon" aria-hidden="true"></span>
            </button>
            <a class="ghost" href="#auth">로그인</a>
            <a class="cta" href="#auth">시작하기</a>
        </div>
    </header>

    <main class="tab-layout">
        <section id="tab-weekly" class="tab-panel is-active" role="tabpanel" aria-labelledby="tab-weekly-btn" tabindex="0">
            <div class="section-title">
                <h2>이번주 당첨번호 & 로또 정보</h2>
                <p id="weekly-status">동행복권 공식 데이터 기준으로 업데이트합니다.</p>
            </div>
            <div class="weekly-hero" aria-live="polite">
                <div class="weekly-hero-card">
                    <div class="weekly-hero-title">이번주 추첨까지</div>
                    <div class="weekly-hero-countdown" id="weekly-countdown">-</div>
                    <div class="weekly-hero-sub" id="weekly-countdown-sub">다음 추첨 시간 계산 중</div>
                </div>
                <div class="weekly-hero-card accent">
                    <div class="weekly-hero-title">예상 1등 당첨금</div>
                    <div class="weekly-hero-amount" id="weekly-expected-amount">-</div>
                    <div class="weekly-hero-sub" id="weekly-expected-note">전회 기준 추정</div>
                </div>
            </div>
            <div class="weekly-controls">
                <label for="weekly-round-select">회차 선택</label>
                <select id="weekly-round-select" aria-label="회차 선택"></select>
                <span class="weekly-hint" id="weekly-round-hint">최신 회차를 불러오는 중</span>
            </div>
            <div class="weekly-primary">
                <div class="info-card" id="weekly-card">
                    <div class="info-header">
                        <h3>기준 회차 당첨번호</h3>
                        <span class="badge" id="weekly-round-badge">조회중</span>
                    </div>
                    <div class="winning-numbers" id="weekly-numbers"></div>
                    <div class="bonus-row">
                        <span class="bonus-label">보너스</span>
                        <div class="number bonus" id="weekly-bonus">-</div>
                    </div>
                    <p class="muted" id="weekly-date">추첨일: -</p>
                    <p class="muted" id="weekly-updated">업데이트: -</p>
                </div>
                <div class="info-card">
                    <div class="info-header">
                        <h3>내 번호 바로 확인</h3>
                        <span class="badge muted">핵심</span>
                    </div>
                    <div class="search-row">
                        <input id="round-search-input" type="number" min="1" placeholder="조회할 회차 입력" inputmode="numeric">
                        <button id="round-search-btn" type="button">회차 조회</button>
                    </div>
                    <div class="compare-grid">
                        <input id="compare-input" type="text" placeholder="예: 1, 7, 12, 19, 27, 34" aria-label="내 번호 6개">
                        <input id="compare-bonus" type="number" min="1" max="45" placeholder="보너스(선택)" aria-label="보너스 번호">
                        <button id="compare-btn" type="button">당첨 확인</button>
                    </div>
                    <div class="compare-result" id="compare-result">번호 6개를 입력하고 당첨 확인을 누르세요.</div>
                </div>
            </div>
            <div class="weekly-insight-grid">
                <div class="info-card">
                    <div class="info-header">
                        <h3>당첨금 핵심 요약</h3>
                        <span class="badge muted" id="weekly-payout-badge">집계</span>
                    </div>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">1등 당첨금</span>
                            <strong id="weekly-first-prize">-</strong>
                        </li>
                        <li>
                            <span class="info-label">1등 당첨자 수</span>
                            <strong id="weekly-first-winners">-</strong>
                        </li>
                        <li>
                            <span class="info-label">총 판매액</span>
                            <strong id="weekly-total-sales">-</strong>
                        </li>
                        <li>
                            <span class="info-label">1등 총 당첨금</span>
                            <strong id="weekly-accumulated">-</strong>
                        </li>
                    </ul>
                </div>
                <div class="info-card">
                    <div class="info-header">
                        <h3>추첨 일정 안내</h3>
                        <span class="badge muted">안내</span>
                    </div>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">추첨일</span>
                            <strong>매주 토요일 20:35</strong>
                        </li>
                        <li>
                            <span class="info-label">구매 마감</span>
                            <strong>토요일 20:00</strong>
                        </li>
                        <li>
                            <span class="info-label">다음 추첨까지</span>
                            <strong id="weekly-next-draw">업데이트 중</strong>
                        </li>
                        <li>
                            <span class="info-label">공식 발표</span>
                            <strong>추첨 직후</strong>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="weekly-recent">
                <div class="weekly-recent-header">
                    <div class="section-title compact">
                        <h3>최근 회차 빠르게 보기</h3>
                        <p>슬라이드로 회차를 선택하면 바로 결과를 갱신합니다.</p>
                    </div>
                    <div class="recent-controls">
                        <label for="recent-count">표시 개수</label>
                        <select id="recent-count" aria-label="최근 회차 개수">
                            <option value="6">6회</option>
                            <option value="8" selected>8회</option>
                            <option value="10">10회</option>
                            <option value="12">12회</option>
                            <option value="20">20회</option>
                        </select>
                    </div>
                </div>
                <div class="recent-list" id="recent-rounds"></div>
            </div>
            <div class="weekly-chart info-card">
                <div class="info-header">
                    <h3>최근 회차 1등 당첨금 분석</h3>
                    <span class="badge muted">최근 데이터</span>
                </div>
                <div class="trend-chart" id="trend-chart"></div>
            </div>
            <details class="weekly-more">
                <summary>추가 참고 정보</summary>
                <div class="weekly-grid">
                <div class="info-card">
                    <div class="info-header">
                        <h3>최근 패턴 브리핑</h3>
                        <span class="badge muted">참고용</span>
                    </div>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">홀짝 비율</span>
                            <strong>3:3 빈도 높음</strong>
                        </li>
                        <li>
                            <span class="info-label">합계 구간</span>
                            <strong>100~170 집중</strong>
                        </li>
                        <li>
                            <span class="info-label">끝자리 반복</span>
                            <strong>1~2개 등장</strong>
                        </li>
                        <li>
                            <span class="info-label">연속수</span>
                            <strong>1~2개 수준</strong>
                        </li>
                    </ul>
                    <p class="muted">패턴은 의사결정 참고 자료이며, 결과를 보장하지 않습니다.</p>
                </div>
                </div>
            </details>
        </section>

        <section id="tab-draw" class="tab-panel" role="tabpanel" aria-labelledby="tab-draw-btn" tabindex="0">
            <div class="draw-studio-header">
                <div class="draw-studio-title">
                    <span class="draw-studio-kicker">Filter Studio</span>
                    <h2>제외 규칙을 설계하면, 확률 변화가 바로 나타납니다.</h2>
                    <p>필터는 “당첨 조합까지 함께 제거될 수 있다”는 가정으로 계산합니다. 실제 당첨 확률은 변하지 않으며 참고용으로만 사용하세요.</p>
                </div>
                <div class="draw-studio-cta">
                    <div class="draw-cta-card">
                        <div class="draw-cta-label">이번 규칙으로 바로 추첨</div>
                        <button type="button" data-generate-cta>번호 생성</button>
                    </div>
                </div>
            </div>

            <section id="rules" class="section rules draw-studio">
                <div class="draw-studio-body">
                    <aside class="draw-builder">
                        <div class="draw-panel">
                            <div class="draw-panel-header">
                                <h3>선택한 필터</h3>
                                <div class="draw-selected-actions">
                                    <span class="draw-selected-count" id="rules-selected-count">0개</span>
                                    <button class="draw-selected-clear" id="selected-clear-btn" type="button">전체 해제</button>
                                </div>
                            </div>
                            <button class="draw-selected-open" id="selected-open-btn" type="button">선택한 필터 보기</button>
                            <div class="draw-selected-presets">
                                <button class="preset-btn" data-preset="light" type="button">보수형</button>
                                <button class="preset-btn" data-preset="balanced" type="button">균형형</button>
                                <button class="preset-btn" data-preset="aggressive" type="button">공격형</button>
                                <button class="preset-btn" data-preset="clear" type="button">선택 해제</button>
                                <button class="preset-btn" id="custom-save" type="button">내 프리셋 저장</button>
                                <button class="preset-btn" id="custom-apply" type="button">내 프리셋 적용</button>
                            </div>
                            <div class="draw-selected-sub" id="rules-visible-count">표시: 0/0</div>
                            <div class="draw-selected-helper">선택된 칩을 누르면 즉시 해제됩니다.</div>
                            <div id="selected-rules-list" class="draw-selected-list"></div>
                            <div id="selected-rules-empty" class="draw-selected-empty">아직 선택된 규칙이 없습니다.</div>
                        </div>

                        <div class="draw-panel">
                            <div class="draw-panel-header">
                                <h3>저장/불러오기</h3>
                            </div>
                            <div class="rules-actions">
                                <button id="save-rules" class="ghost" type="button">규칙 저장</button>
                                <button id="load-rules" class="ghost" type="button">저장 불러오기</button>
                                <span id="rules-status" class="rules-status" aria-live="polite"></span>
                            </div>
                        </div>
                    </aside>

                    <main class="draw-dashboard">
                        <div class="draw-dashboard-grid">
                            <div class="draw-metric-card primary">
                                <div class="draw-metric-title">남은 조합 비중</div>
                                <div class="draw-live-meter">
                                    <div class="draw-live-fill" id="remaining-meter-fill"></div>
                                </div>
                                <div class="draw-metric-value" id="remaining-meter-label">남은 조합 비중: -</div>
                            </div>
                            <div class="draw-metric-card">
                                <div class="draw-metric-title">남은 조합</div>
                                <div class="draw-metric-value" id="remaining-combos">계산중</div>
                                <div class="draw-metric-sub" id="excluded-combos">제외: -</div>
                            </div>
                            <div class="draw-metric-card">
                                <div class="draw-metric-title">필터 영향</div>
                                <div class="draw-metric-value" id="odds-benefit-summary">-</div>
                                <div class="draw-metric-sub">조합 감소율</div>
                            </div>
                            <div class="draw-metric-card wide">
                                <div class="draw-odds-title">확률 변화 그래프 (1등 기준)</div>
                                <div class="odds-graph">
                                    <div class="odds-graph-row">
                                        <span class="odds-rank">1등</span>
                                        <div class="odds-bar">
                                            <span class="odds-bar-base"></span>
                                            <span class="odds-bar-adj" id="odds-bar-1"></span>
                                        </div>
                                        <span class="odds-delta" id="odds-delta-1">-</span>
                                        <span class="odds-graph-sub"><span id="odds-base-1">1 / 8,145,060</span> → <span id="odds-adj-1">-</span></span>
                                    </div>
                                </div>
                                <div class="odds-graph-note">
                                    2~5등도 동일 비율로 변화합니다.
                                    <div class="odds-graph-inline">
                                        2등 <span id="odds-base-2">1 / 1,357,510</span> → <span id="odds-adj-2">-</span>
                                    </div>
                                    <div class="odds-graph-inline">
                                        3등 <span id="odds-base-3">1 / 35,724</span> → <span id="odds-adj-3">-</span>
                                    </div>
                                    <div class="odds-graph-inline">
                                        4등 <span id="odds-base-4">1 / 733</span> → <span id="odds-adj-4">-</span>
                                    </div>
                                    <div class="odds-graph-inline">
                                        5등 <span id="odds-base-5">1 / 45</span> → <span id="odds-adj-5">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="draw-rules-panel">
                            <div class="draw-rules-header">
                                <div>
                                    <h3>Rule Library</h3>
                                    <p>탭으로 규칙을 토글하세요. 각 규칙은 “예상 제외 수”를 함께 보여줍니다.</p>
                                </div>
                                <div class="draw-rules-legend">
                                    <span class="legend-chip">탭하여 선택/해제</span>
                                    <span class="legend-chip muted">예상 제외 수 표시</span>
                                </div>
                            </div>
                            <div class="rules-toggle-row">
                                <button id="toggle-rules" class="ghost" type="button">모든 규칙 펼치기</button>
                                <span class="rules-hint">기본은 핵심 규칙만 보여줍니다</span>
                            </div>
                            <div class="rules-groups">
                <div class="rule-group is-essential" data-group="홀짝 비율">
                    <div class="rule-group-header">
                        <h3>홀짝 비율</h3>
                        <button class="group-select" type="button" data-group="홀짝 비율">모두 선택</button>
                    </div>
                    <p class="rule-group-note">홀수/짝수의 비율이 과도하게 치우친 조합을 제외합니다.</p>
                    <div class="rules-grid">
                        <label class="rule-card" data-title="모두 홀수" data-group="홀짝 비율">
                            <input class="rule-input" type="checkbox" value="all_odd">
                            <span class="rule-body">
                                <span class="rule-title">모두 홀수</span>
                                <span class="rule-desc">홀수만 6개</span>
                                <span class="rule-stat" data-rule="all_odd">예상 제외: 약 97,944개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="모두 짝수" data-group="홀짝 비율">
                            <input class="rule-input" type="checkbox" value="all_even">
                            <span class="rule-body">
                                <span class="rule-title">모두 짝수</span>
                                <span class="rule-desc">짝수만 6개</span>
                                <span class="rule-stat" data-rule="all_even">예상 제외: 약 77,460개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="홀수 5 + 짝수 1" data-group="홀짝 비율">
                            <input class="rule-input" type="checkbox" value="five_odd_one_even">
                            <span class="rule-body">
                                <span class="rule-title">홀수 5 + 짝수 1</span>
                                <span class="rule-desc">홀수 편중</span>
                                <span class="rule-stat" data-rule="five_odd_one_even">예상 제외: 약 737,780개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="짝수 5 + 홀수 1" data-group="홀짝 비율">
                            <input class="rule-input" type="checkbox" value="five_even_one_odd">
                            <span class="rule-body">
                                <span class="rule-title">짝수 5 + 홀수 1</span>
                                <span class="rule-desc">짝수 편중</span>
                                <span class="rule-stat" data-rule="five_even_one_odd">예상 제외: 약 600,006개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="홀수 4 + 짝수 2" data-group="홀짝 비율">
                            <input class="rule-input" type="checkbox" value="four_odd_two_even">
                            <span class="rule-body">
                                <span class="rule-title">홀수 4 + 짝수 2</span>
                                <span class="rule-desc">홀수 우세</span>
                                <span class="rule-stat" data-rule="four_odd_two_even">예상 제외: 약 2,044,695개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="짝수 4 + 홀수 2" data-group="홀짝 비율">
                            <input class="rule-input" type="checkbox" value="four_even_two_odd">
                            <span class="rule-body">
                                <span class="rule-title">짝수 4 + 홀수 2</span>
                                <span class="rule-desc">짝수 우세</span>
                                <span class="rule-stat" data-rule="four_even_two_odd">예상 제외: 약 1,861,350개</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="rule-group is-essential" data-group="배수 분포">
                    <div class="rule-group-header">
                        <h3>배수 분포</h3>
                        <button class="group-select" type="button" data-group="배수 분포">모두 선택</button>
                    </div>
                    <p class="rule-group-note">특정 배수가 과도하게 포함된 조합을 제외합니다.</p>
                    <div class="rules-grid">
                        <label class="rule-card" data-title="2의 배수 4개 이상" data-group="배수 분포">
                            <input class="rule-input" type="checkbox" value="multiples_of_2_4_plus">
                            <span class="rule-body">
                                <span class="rule-title">2의 배수 4개 이상</span>
                                <span class="rule-desc">짝수 과다</span>
                                <span class="rule-stat" data-rule="multiples_of_2_4_plus">예상 제외: 약 2,538,815개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="3의 배수 3개 이상" data-group="배수 분포">
                            <input class="rule-input" type="checkbox" value="multiples_of_3_3_plus">
                            <span class="rule-body">
                                <span class="rule-title">3의 배수 3개 이상</span>
                                <span class="rule-desc">3의 배수 과다</span>
                                <span class="rule-stat" data-rule="multiples_of_3_3_plus">예상 제외: 약 2,541,503개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="2의 배수 5개 이상" data-group="배수 분포">
                            <input class="rule-input" type="checkbox" value="multiples_of_2_5_plus">
                            <span class="rule-body">
                                <span class="rule-title">2의 배수 5개 이상</span>
                                <span class="rule-desc">짝수 매우 많음</span>
                                <span class="rule-stat" data-rule="multiples_of_2_5_plus">예상 제외: 약 672,660개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="4의 배수 3개 이상" data-group="배수 분포">
                            <input class="rule-input" type="checkbox" value="multiples_of_4_3_plus">
                            <span class="rule-body">
                                <span class="rule-title">4의 배수 3개 이상</span>
                                <span class="rule-desc">4의 배수 과다</span>
                                <span class="rule-stat" data-rule="multiples_of_4_3_plus">예상 제외: 약 1,182,581개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="5의 배수 3개 이상" data-group="배수 분포">
                            <input class="rule-input" type="checkbox" value="multiples_of_5_3_plus">
                            <span class="rule-body">
                                <span class="rule-title">5의 배수 3개 이상</span>
                                <span class="rule-desc">5의 배수 과다</span>
                                <span class="rule-stat" data-rule="multiples_of_5_3_plus">예상 제외: 약 683,126개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="6의 배수 3개 이상" data-group="배수 분포">
                            <input class="rule-input" type="checkbox" value="multiples_of_6_3_plus">
                            <span class="rule-body">
                                <span class="rule-title">6의 배수 3개 이상</span>
                                <span class="rule-desc">6의 배수 과다</span>
                                <span class="rule-stat" data-rule="multiples_of_6_3_plus">예상 제외: 약 319,612개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="7의 배수 3개 이상" data-group="배수 분포">
                            <input class="rule-input" type="checkbox" value="multiples_of_7_3_plus">
                            <span class="rule-body">
                                <span class="rule-title">7의 배수 3개 이상</span>
                                <span class="rule-desc">7의 배수 과다</span>
                                <span class="rule-stat" data-rule="multiples_of_7_3_plus">예상 제외: 약 190,513개</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="rule-group is-essential" data-group="연속/반복">
                    <div class="rule-group-header">
                        <h3>연속/반복</h3>
                        <button class="group-select" type="button" data-group="연속/반복">모두 선택</button>
                    </div>
                    <p class="rule-group-note">연속된 숫자 구간이 많은 조합을 제외합니다.</p>
                    <div class="rules-grid">
                        <label class="rule-card" data-title="연속수 3개 이상" data-group="연속/반복">
                            <input class="rule-input" type="checkbox" value="consecutive_3_plus">
                            <span class="rule-body">
                                <span class="rule-title">연속수 3개 이상</span>
                                <span class="rule-desc">연속수 3개 이상</span>
                                <span class="rule-stat" data-rule="consecutive_3_plus">예상 제외: 약 458,933개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="연속수 4개 이상" data-group="연속/반복">
                            <input class="rule-input" type="checkbox" value="consecutive_4_plus">
                            <span class="rule-body">
                                <span class="rule-title">연속수 4개 이상</span>
                                <span class="rule-desc">연속수 4개 이상</span>
                                <span class="rule-stat" data-rule="consecutive_4_plus">예상 제외: 약 31,929개</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="rule-group is-essential" data-group="끝자리 분포">
                    <div class="rule-group-header">
                        <h3>끝자리 분포</h3>
                        <button class="group-select" type="button" data-group="끝자리 분포">모두 선택</button>
                    </div>
                    <p class="rule-group-note">끝자리 숫자가 반복되거나 특정 끝자리가 많은 조합을 제외합니다.</p>
                    <div class="rules-grid">
                        <label class="rule-card" data-title="끝자리 동일 3개 이상" data-group="끝자리 분포">
                            <input class="rule-input" type="checkbox" value="same_last_digit_3_plus">
                            <span class="rule-body">
                                <span class="rule-title">끝자리 동일 3개 이상</span>
                                <span class="rule-desc">끝자리 3개 동일</span>
                                <span class="rule-stat" data-rule="same_last_digit_3_plus">예상 제외: 약 729,268개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="끝자리 동일 4개 이상" data-group="끝자리 분포">
                            <input class="rule-input" type="checkbox" value="same_last_digit_4_plus">
                            <span class="rule-body">
                                <span class="rule-title">끝자리 동일 4개 이상</span>
                                <span class="rule-desc">끝자리 4개 동일</span>
                                <span class="rule-stat" data-rule="same_last_digit_4_plus">예상 제외: 약 24,557개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="끝자리 동일 2개 이상" data-group="끝자리 분포">
                            <input class="rule-input" type="checkbox" value="last_digit_2_plus">
                            <span class="rule-body">
                                <span class="rule-title">끝자리 동일 2개 이상</span>
                                <span class="rule-desc">끝자리 중복</span>
                                <span class="rule-stat" data-rule="last_digit_2_plus">예상 제외: 약 6,440,625개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="끝자리 0 포함 2개 이상" data-group="끝자리 분포">
                            <input class="rule-input" type="checkbox" value="last_digit_zero_2_plus">
                            <span class="rule-body">
                                <span class="rule-title">끝자리 0 포함 2개 이상</span>
                                <span class="rule-desc">끝자리 0 과다</span>
                                <span class="rule-stat" data-rule="last_digit_zero_2_plus">예상 제외: 약 652,582개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="끝자리 5 포함 2개 이상" data-group="끝자리 분포">
                            <input class="rule-input" type="checkbox" value="last_digit_five_2_plus">
                            <span class="rule-body">
                                <span class="rule-title">끝자리 5 포함 2개 이상</span>
                                <span class="rule-desc">끝자리 5 과다</span>
                                <span class="rule-stat" data-rule="last_digit_five_2_plus">예상 제외: 약 1,009,825개</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="rule-group is-essential" data-group="구간 분포">
                    <div class="rule-group-header">
                        <h3>구간 분포</h3>
                        <button class="group-select" type="button" data-group="구간 분포">모두 선택</button>
                    </div>
                    <p class="rule-group-note">낮은 수/높은 수가 한쪽으로 쏠린 조합을 제외합니다.</p>
                    <div class="rules-grid">
                        <label class="rule-card" data-title="같은 구간 4개 이상" data-group="구간 분포">
                            <input class="rule-input" type="checkbox" value="same_decade_4_plus">
                            <span class="rule-body">
                                <span class="rule-title">같은 구간 4개 이상</span>
                                <span class="rule-desc">10단위 몰림</span>
                                <span class="rule-stat" data-rule="same_decade_4_plus">예상 제외: 약 496,930개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="같은 구간 5개 이상" data-group="구간 분포">
                            <input class="rule-input" type="checkbox" value="same_decade_5_plus">
                            <span class="rule-body">
                                <span class="rule-title">같은 구간 5개 이상</span>
                                <span class="rule-desc">10단위 과다</span>
                                <span class="rule-stat" data-rule="same_decade_5_plus">예상 제외: 약 33,028개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="저구간 또는 고구간 몰림" data-group="구간 분포">
                            <input class="rule-input" type="checkbox" value="all_low_or_high">
                            <span class="rule-body">
                                <span class="rule-title">저구간 또는 고구간 몰림</span>
                                <span class="rule-desc">저/고 구간 몰림</span>
                                <span class="rule-stat" data-rule="all_low_or_high">예상 제외: 약 176,911개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="저구간/고구간 5개 이상" data-group="구간 분포">
                            <input class="rule-input" type="checkbox" value="low_or_high_5_plus">
                            <span class="rule-body">
                                <span class="rule-title">저구간/고구간 5개 이상</span>
                                <span class="rule-desc">한쪽 과다</span>
                                <span class="rule-stat" data-rule="low_or_high_5_plus">예상 제외: 약 1,523,574개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="범위 20 미만" data-group="구간 분포">
                            <input class="rule-input" type="checkbox" value="tight_range">
                            <span class="rule-body">
                                <span class="rule-title">범위 20 미만</span>
                                <span class="rule-desc">숫자 폭 좁음</span>
                                <span class="rule-stat" data-rule="tight_range">예상 제외: 약 331,463개</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="rule-group is-essential" data-group="구간 세분">
                    <div class="rule-group-header">
                        <h3>구간 세분</h3>
                        <button class="group-select" type="button" data-group="구간 세분">모두 선택</button>
                    </div>
                    <p class="rule-group-note">1~15, 16~30, 31~45 구간 중 특정 구간 몰림을 제외합니다.</p>
                    <div class="rules-grid">
                        <label class="rule-card" data-title="저구간 4개 이상" data-group="구간 세분">
                            <input class="rule-input" type="checkbox" value="low_1_15_4_plus">
                            <span class="rule-body">
                                <span class="rule-title">저구간 4개 이상</span>
                                <span class="rule-desc">1-15 구간 몰림</span>
                                <span class="rule-stat" data-rule="low_1_15_4_plus">예상 제외: 약 690,864개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="중간구간 4개 이상" data-group="구간 세분">
                            <input class="rule-input" type="checkbox" value="mid_16_30_4_plus">
                            <span class="rule-body">
                                <span class="rule-title">중간구간 4개 이상</span>
                                <span class="rule-desc">16-30 구간 몰림</span>
                                <span class="rule-stat" data-rule="mid_16_30_4_plus">예상 제외: 약 685,407개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="고구간 4개 이상" data-group="구간 세분">
                            <input class="rule-input" type="checkbox" value="high_31_45_4_plus">
                            <span class="rule-body">
                                <span class="rule-title">고구간 4개 이상</span>
                                <span class="rule-desc">31-45 구간 몰림</span>
                                <span class="rule-stat" data-rule="high_31_45_4_plus">예상 제외: 약 682,841개</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="rule-group is-essential" data-group="합계/소수">
                    <div class="rule-group-header">
                        <h3>합계/소수</h3>
                        <button class="group-select" type="button" data-group="합계/소수">모두 선택</button>
                    </div>
                    <p class="rule-group-note">합계의 극단값이나 소수 분포가 과한 조합을 제외합니다.</p>
                    <div class="rules-grid">
                        <label class="rule-card" data-title="합계 80 이하 또는 200 이상" data-group="합계/소수">
                            <input class="rule-input" type="checkbox" value="extreme_sum">
                            <span class="rule-body">
                                <span class="rule-title">합계 80 이하 또는 200 이상</span>
                                <span class="rule-desc">합계 극단</span>
                                <span class="rule-stat" data-rule="extreme_sum">예상 제외: 약 369,664개</span>
                            </span>
                        </label>
                        <label class="rule-card" data-title="합계 100 이하" data-group="합계/소수">
                            <input class="rule-input" type="checkbox" value="sum_low_100">
                            <span class="rule-body">
                                <span class="rule-title">합계 100 이하</span>
                                <span class="rule-desc">합계 낮음</span>
                                <span class="rule-stat" data-rule="sum_low_100">예상 제외: 약 888,870개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="합계 180 이상" data-group="합계/소수">
                            <input class="rule-input" type="checkbox" value="sum_high_180">
                            <span class="rule-body">
                                <span class="rule-title">합계 180 이상</span>
                                <span class="rule-desc">합계 높음</span>
                                <span class="rule-stat" data-rule="sum_high_180">예상 제외: 약 692,534개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="소수 4개 이상" data-group="합계/소수">
                            <input class="rule-input" type="checkbox" value="prime_4_plus">
                            <span class="rule-body">
                                <span class="rule-title">소수 4개 이상</span>
                                <span class="rule-desc">소수 과다</span>
                                <span class="rule-stat" data-rule="prime_4_plus">예상 제외: 약 530,610개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="소수 1개 이하" data-group="합계/소수">
                            <input class="rule-input" type="checkbox" value="prime_1_or_less">
                            <span class="rule-body">
                                <span class="rule-title">소수 1개 이하</span>
                                <span class="rule-desc">소수 부족</span>
                                <span class="rule-stat" data-rule="prime_1_or_less">예상 제외: 약 3,106,770개</span>
                            </span>
                        </label>
                        <label class="rule-card is-advanced" data-title="소수 0개" data-group="합계/소수">
                            <input class="rule-input" type="checkbox" value="prime_0">
                            <span class="rule-body">
                                <span class="rule-title">소수 0개</span>
                                <span class="rule-desc">소수 없음</span>
                                <span class="rule-stat" data-rule="prime_0">예상 제외: 약 732,607개</span>
                            </span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
                    </main>
                </div>
            </section>
            <div class="draw-fixed-cta">
                <button type="button" data-generate-cta>번호 생성</button>
            </div>
            <div class="selected-sheet" id="selected-sheet" aria-hidden="true">
                <div class="selected-sheet-inner">
                    <div class="selected-sheet-header">
                        <h3>선택한 필터</h3>
                        <button type="button" id="selected-close-btn">닫기</button>
                    </div>
                    <div class="draw-selected-helper">필터를 누르면 즉시 해제됩니다.</div>
                    <div id="selected-rules-list-sheet" class="draw-selected-list"></div>
                    <div id="selected-rules-empty-sheet" class="draw-selected-empty">아직 선택된 규칙이 없습니다.</div>
                </div>
            </div>

            <section id="generator" class="section generator">
                <div class="section-title">
                    <h2>필터 적용 추첨</h2>
                    <p>세트 수를 고른 뒤 규칙을 적용해 번호를 생성하세요.</p>
                </div>
                <div class="generator-panel">
                    <div class="controls">
                        <label for="draw-count">한 번에 생성할 세트</label>
                        <select id="draw-count">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                        <button id="generate-btn">번호 생성</button>
                    </div>
                    <div class="numbers-container"></div>
                    <div class="notice-bar" id="guest-banner">
                        비회원은 하루 5회, 1회 1세트만 가능합니다. 로그인하면 제한이 해제됩니다.
                    </div>
                    <p class="helper-text" id="guest-limit">비회원은 하루 5회까지 가능 (1회 1세트).</p>
                    <p class="helper-text">팁: 결과가 없다면 규칙을 줄여 보세요.</p>
                </div>
            </section>
        </section>

        <section id="tab-mypage" class="tab-panel" role="tabpanel" aria-labelledby="tab-mypage-btn" tabindex="0">
            <div class="section-title">
                <h2>마이페이지</h2>
                <p>나의 추첨 기록과 프리셋을 관리합니다.</p>
            </div>
            <div class="mypage-grid">
                <div class="info-card">
                    <div class="info-header">
                        <h3>내 정보</h3>
                        <span class="badge muted">비회원</span>
                    </div>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">닉네임</span>
                            <strong>로그인 시 자동 설정</strong>
                        </li>
                        <li>
                            <span class="info-label">멤버십</span>
                            <strong>무료</strong>
                        </li>
                        <li>
                            <span class="info-label">잔여 추첨 횟수</span>
                            <strong>5회</strong>
                        </li>
                    </ul>
                </div>
                <div class="info-card">
                    <div class="info-header">
                        <h3>저장된 프리셋</h3>
                        <span class="badge muted">0개</span>
                    </div>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">내 프리셋</span>
                            <strong>저장된 프리셋 없음</strong>
                        </li>
                        <li>
                            <span class="info-label">최근 적용</span>
                            <strong>-</strong>
                        </li>
                        <li>
                            <span class="info-label">공유 설정</span>
                            <strong>비공개</strong>
                        </li>
                    </ul>
                </div>
                <div class="info-card">
                    <div class="info-header">
                        <h3>추첨 히스토리</h3>
                        <span class="badge muted">최근 3회</span>
                    </div>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">2026-02-15</span>
                            <strong>1세트 생성</strong>
                        </li>
                        <li>
                            <span class="info-label">2026-02-14</span>
                            <strong>2세트 생성</strong>
                        </li>
                        <li>
                            <span class="info-label">2026-02-13</span>
                            <strong>1세트 생성</strong>
                        </li>
                    </ul>
                </div>
                <div class="info-card">
                    <div class="info-header">
                        <h3>결제/구독</h3>
                        <span class="badge muted">설정</span>
                    </div>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">현재 플랜</span>
                            <strong>무료</strong>
                        </li>
                        <li>
                            <span class="info-label">다음 결제일</span>
                            <strong>-</strong>
                        </li>
                        <li>
                            <span class="info-label">구독 관리</span>
                            <strong>문의 후 안내</strong>
                        </li>
                    </ul>
                </div>
            </div>

            <section id="auth" class="section auth">
                <div class="section-title">
                    <h2>회원가입 및 로그인</h2>
                    <p>구글 또는 카카오 계정으로 간편하게 시작할 수 있습니다.</p>
                </div>
                <div class="auth-grid">
                    <div class="auth-card">
                        <h3>간편 가입</h3>
                        <p>구글/카카오 연동으로 빠르게 시작합니다.</p>
                        <div class="auth-buttons">
                            <button class="auth-btn google" data-auth="google">
                                <span class="auth-icon google" aria-hidden="true"></span>
                                구글로 시작
                            </button>
                            <button class="auth-btn kakao" data-auth="kakao">
                                <span class="auth-icon kakao" aria-hidden="true"></span>
                                카카오로 시작
                            </button>
                        </div>
                    </div>
                    <div class="auth-card">
                        <h3>비회원 이용 안내</h3>
                        <p>비회원은 하루 최대 5회, 1회 1세트만 추첨 가능합니다.</p>
                        <ul class="bullets">
                            <li>세션 기준으로 횟수 제한</li>
                            <li>회원 가입 시 제한 해제</li>
                        </ul>
                    </div>
                </div>
            </section>
        </section>

        <section id="tab-store" class="tab-panel" role="tabpanel" aria-labelledby="tab-store-btn" tabindex="0">
            <div class="section-title">
                <h2>내 주변 판매점</h2>
                <p>현재 위치를 기준으로 가까운 판매점을 바로 확인하세요.</p>
            </div>
            <div class="store-controls" role="group" aria-label="판매점 검색">
                <button id="store-locate-btn" type="button">현재 위치로 검색</button>
                <button id="store-retry-btn" type="button" class="ghost">다시 조회</button>
                <label for="store-radius">검색 반경</label>
                <select id="store-radius" aria-label="검색 반경">
                    <option value="1000">1km</option>
                    <option value="2000" selected>2km</option>
                    <option value="3000">3km</option>
                    <option value="5000">5km</option>
                    <option value="8000">8km</option>
                </select>
            </div>
            <p id="store-status" class="muted" aria-live="polite">현재 위치로 주변 판매점을 조회해 보세요.</p>

            <div class="store-layout">
                <div class="store-results">
                    <div id="store-map" class="store-map" aria-label="주변 판매점 지도"></div>
                    <div class="store-table-wrap">
                        <table class="store-table">
                            <thead>
                                <tr>
                                    <th>순서</th>
                                    <th>판매점</th>
                                    <th>주소</th>
                                    <th>거리</th>
                                    <th>길찾기</th>
                                </tr>
                            </thead>
                            <tbody id="store-table-body"></tbody>
                        </table>
                        <div id="store-table-empty" class="store-empty" hidden>검색된 판매점이 없습니다.</div>
                    </div>
                </div>
                <div class="store-grid-wrap">
                    <div id="store-grid" class="store-grid"></div>
                    <div id="store-grid-empty" class="store-empty" hidden>검색된 판매점이 없습니다.</div>
                    <div class="store-next-actions">
                        <button id="store-nearest-route-btn" type="button">가까운 판매점 길찾기</button>
                        <button id="store-switch-qr-btn" type="button" class="ghost">QR 스캔으로 이동</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-qr" class="tab-panel" role="tabpanel" aria-labelledby="tab-qr-btn" tabindex="0">
            <div class="section-title">
                <h2>QR 스캔</h2>
                <p id="qr-status">카메라 권한을 허용한 뒤 로또 QR을 비춰 당첨 여부를 확인하세요.</p>
            </div>
            <div class="qr-layout">
                <div class="qr-camera-card">
                    <div class="qr-camera-head">
                        <h3>실시간 스캔</h3>
                        <span class="badge muted">카메라</span>
                    </div>
                    <div class="qr-preview">
                        <video id="qr-video" autoplay playsinline muted></video>
                        <div class="qr-frame" aria-hidden="true"></div>
                    </div>
                    <canvas id="qr-canvas" class="qr-canvas" aria-hidden="true"></canvas>
                    <div class="qr-actions">
                        <button id="qr-start-btn" type="button">스캔 시작</button>
                        <button id="qr-stop-btn" type="button" class="ghost">스캔 중지</button>
                    </div>
                </div>
                <div class="qr-result-card">
                    <div class="qr-result-head">
                        <h3>스캔 결과</h3>
                        <span class="badge muted" id="qr-result-badge">대기 중</span>
                    </div>
                    <div class="qr-block">
                        <span class="qr-label">인식된 번호</span>
                        <div id="qr-ticket-numbers" class="qr-numbers">-</div>
                    </div>
                    <div class="qr-block">
                        <span class="qr-label">당첨 비교</span>
                        <div id="qr-match-result" class="qr-match">QR을 스캔하면 결과가 표시됩니다.</div>
                    </div>
                    <div class="qr-block">
                        <span class="qr-label">원본 QR 데이터</span>
                        <pre id="qr-payload" class="qr-payload">-</pre>
                    </div>
                    <div class="qr-next-actions">
                        <button id="qr-open-round-btn" type="button">해당 회차 보기</button>
                        <button id="qr-copy-numbers-btn" type="button" class="ghost">번호 복사</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <nav class="bottom-tab-bar" role="tablist" aria-label="하단 탭">
        <button class="tab-btn is-active" id="tab-weekly-btn" type="button" role="tab" aria-selected="true" aria-controls="tab-weekly" data-tab="weekly">
            <span class="tab-icon icon-weekly" aria-hidden="true"></span>
            <span class="tab-label">이번주</span>
        </button>
        <button class="tab-btn" id="tab-draw-btn" type="button" role="tab" aria-selected="false" aria-controls="tab-draw" data-tab="draw">
            <span class="tab-icon icon-draw" aria-hidden="true"></span>
            <span class="tab-label">추첨</span>
        </button>
        <button class="tab-btn" id="tab-mypage-btn" type="button" role="tab" aria-selected="false" aria-controls="tab-mypage" data-tab="mypage">
            <span class="tab-icon icon-mypage" aria-hidden="true"></span>
            <span class="tab-label">마이페이지</span>
        </button>
        <button class="tab-btn" id="tab-store-btn" type="button" role="tab" aria-selected="false" aria-controls="tab-store" data-tab="store">
            <span class="tab-icon icon-store" aria-hidden="true"></span>
            <span class="tab-label">판매점</span>
        </button>
        <button class="tab-btn" id="tab-qr-btn" type="button" role="tab" aria-selected="false" aria-controls="tab-qr" data-tab="qr">
            <span class="tab-icon icon-qr" aria-hidden="true"></span>
            <span class="tab-label">QR스캔</span>
        </button>
    </nav>

    <div id="auth-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="auth-title">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="auth-title">간편 로그인</h3>
                <button class="modal-close" type="button" aria-label="닫기">닫기</button>
            </div>
            <p class="modal-text">구글 또는 카카오 계정으로 로그인하면 제한이 해제됩니다.</p>
            <div class="auth-buttons">
                <button class="auth-btn google" data-auth="google">
                    <span class="auth-icon google" aria-hidden="true"></span>
                    구글로 시작
                </button>
                <button class="auth-btn kakao" data-auth="kakao">
                    <span class="auth-icon kakao" aria-hidden="true"></span>
                    카카오로 시작
                </button>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <p>로또픽스튜디오. 결과를 보장하지 않으며 선택 과정을 돕기 위한 도구입니다.</p>
    </footer>

    <div id="detail-sheet" class="detail-sheet" role="dialog" aria-modal="true">
        <h4>규칙 상세</h4>
        <p>설명</p>
        <button class="sheet-close" type="button">닫기</button>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <script src="main.js?v=20260227"></script>
</body>
</html>
